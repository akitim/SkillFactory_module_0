---------------Задание 4.1------------------
-- В большинстве городов есть только один аэропорт. Исключение составляет:

-- SELECT a.city,
--       count(a.airport_code)
-- FROM dst_project.airports a
-- GROUP BY 1
-- HAVING count(a.airport_code) > 1

-- =========================================
---------------Задание 4.2------------------
----------------Вопрос 1--------------------
-- Сколько всего статусов для рейсов определено в таблице?

-- SELECT count (distinct f.status)
-- from dst_project.flights f

----------------Вопрос 2--------------------
-- Какое количество самолетов находятся в воздухе на момент среза в базе?

-- SELECT COUNT (f.status)
-- FROM dst_project.flights f
-- WHERE f.status in ('Departed')

----------------Вопрос 3--------------------
-- Сколько мест имеет самолет модели  (Boeing 777-300)?

-- SELECT count(s.seat_no) Num_of_seats_in_Boeing_773
-- FROM dst_project.seats s
-- LEFT JOIN dst_project.aircrafts a ON s.aircraft_code=a.aircraft_code
-- WHERE a.model = 'Boeing 777-300'

    
----------------Вопрос 4--------------------
--  Сколько состоявшихся (фактических) рейсов было совершено между 1 апреля 2017 года и 1 сентября 2017 года?

-- SELECT count(f.flight_id) num_of_flights
-- FROM dst_project.flights f
-- WHERE f.status != 'Cancelled'
--   AND f.actual_arrival BETWEEN '04-01-2017, 00:00'::TIMESTAMP AND '09-01-2017, 00:00'::TIMESTAMP
-- =========================================
---------------Задание 4.2------------------
-- Вопрос 1. Сколько всего рейсов было отменено по данным базы?

-- SELECT count(f.flight_id)
-- FROM dst_project.flights f
-- WHERE f.status = 'Cancelled'
-- =========================================
-- Вопрос 2. Сколько самолетов моделей типа Boeing, Sukhoi Superjet, Airbus находится в базе авиаперевозок?

-- SELECT count(f.flight_id)
-- FROM dst_project.flights f
--         left join dst_project.aircrafts a
--             on f.aircraft_code = a.aircraft_code
-- WHERE true

SELECT 'Boeing' aircraft_type, count(a.model) number
FROM dst_project.aircrafts a
where a.model like '%Boeing%'
union all
SELECT 'Sukhoi Superjet' aircraft_type, count(a.model) number
FROM dst_project.aircrafts a
where a.model like '%Sukhoi Superjet%'
union all
SELECT 'Airbus' aircraft_type, count(a.model) number
FROM dst_project.aircrafts a
where a.model like '%Airbus%'
-- =========================================
-- =========================================
-- =========================================
-- =========================================
